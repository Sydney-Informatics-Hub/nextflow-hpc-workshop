# 2.2 Running nf-core pipelines

## 2.2.1 Prepraring the environment

!!! example "Exercise 2.2.1: Inspecting the nf-core/sarek workflow and environment"

    Up until now we have been working in `/scratch/<PROJECT_ID>/<USERNAME>/01.hpc_fundamentals/`. For this next section of the workshop, we will be moving into the neighbouring folder `02.nf-core/`:

    ```bash
    cd ../02.nf-core
    ls
    ```

    ```console title="Output"
    data/
    ref/
    samplesheet.csv
    ```

    We will take a few minutes here to inspect these files and understand the workflow we will be running.

    First, open the file `samplesheet.csv` in VSCode. You will see a comma-separated values file with two lines: one header line, and one line for a single sample that we will process:

    ```csv
    patient,sample,bam,bai
    na12878,test_sample,data/NA12878.20-22.bam,data/NA12878.20-22.bam.bai
    ```

    Note that there are four columns in this file:
    
    - `patient`: A patient ID uniquely identifying the individual the sample came from.
    - `sample`: A sample ID; multiple samples (e.g. tumor and healthy samples) can come from the same patient.
    - `bam`: A path to a BAM alignment file.
    - `bai`: A path to the BAM's index file.

    For the purposes of this workshop, we will just be working with a single sample. We will also be working with a very small part of the full `nf-core/sarek` workflow. The full pipeline has lots of features and different tracks for processing samples in different ways. For today, we will just work with part of the pre-processing steps, where we take a pre-aligned set of reads in BAM format and mark the duplicate reads.

    Let's now take a look at the data we'll be using. In the `data/` folder there are two files - the BAM and the BAI files referenced in the samplesheet:

    ```bash
    ls data
    ```

    ```console title="Output"
    NA12878.20-22.bam  NA12878.20-22.bam.bai
    ```

    And in the `ref/` folder we have several reference genome files:

    ```bash
    ls ref
    ```

    ```console title="Output"
    Homo_sapiens_assembly38.20-22.dict  Homo_sapiens_assembly38.20-22.fasta  Homo_sapiens_assembly38.20-22.fasta.fai
    ```

    The file `Homo_sapiens_assembly38.20-22.fasta` is the human reference genome in FASTA format for chromosomes 20, 21, and 22 (a small subset of the genome that is all we need for today's purposes). The file `Homo_sapiens_assembly38.20-22.fasta.fai` is an index file that pairs with the FASTA file and is used by tools to quickly find positions within the genome. The third file `Homo_sapiens_assembly38.20-22.dict` is a dictionary file which is also paired with the FASTA file and is used by some tools for additional information about the genome.

## 2.2.2 Write a simple run script

## 2.2.3 Running the pipeline
